{% extends 'HomePage.html.twig' %}

{% block body %}
  <script language="javascript"></script>

  <div id="community-container"
    class="gradient-container blur-container marge-box scrollable">
    <nav class="navbar navbar-expand-lg gradient-container blur-container"
      style="border-radius: 10px;">
      <div class="navbar-brand">
        <i class="fas fa-user-friends fa-sm colored-icon"></i>
        {{ controller_name }}
      </div>
      <button style="border:none; color: white;"
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#eventPanel"
        aria-controls="eventPanel"
        aria-expanded="false"
        aria-label="Toggle navigation">
        <i class="fas fa-chevron-down"></i>
      </button>
      <div class="collapse navbar-collapse" id="eventPanel">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <button type="button"
              class="btn btn-outline-info"
              onclick="location.href='/community/create';">
              <i class="fas fa-plus-circle"></i>
              Cr√©er
            </button>
          </li>
        </ul>
      </div>
    </nav>
    <div id="community-subcontainer" class="subcontainer scrollbar">
      <div class="row">
        {% for community in communitys %}
          <div class="col-sm-3">
            <div class="community-card">
              <img src="{{ asset('build/wejdene.jpg') }}"
                width="70px"
                height="70px" />
              <div>
                <h4 class="card-title">
                  {{ community.name }}
                </h4>
                {% set communityid = {
                  id: community.id
                } %}
                {% if communityid in isInCommunitys %}
                  <button onclick="onClickBtnGoTo('{{ path('community_goto', {communityId: community.id}) }}')" id="{{ community.id }}" class="btn btn-outline-danger btn-round js-goTo">
                    <i class="fas fa-times"></i>
                  </button>
                {% else %}
                  <button onclick="onClickBtnGoTo('{{ path('community_goto', {communityId: community.id}) }}')" id="{{ community.id }}" class="btn btn-outline-warning btn-round js-goTo">
                    <i class="fas fa-plus"></i>
                  </button>
                {% endif %}
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
{% endblock %}

{% block javascripts %}
  <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
  <script>
    function onClickBtnGoTo(communityGoToPath) {
      $.ajax({ 
        url: communityGoToPath,
        cache: false
      }).done(function(response) { 
        $("#community-subcontainer").load("/community #community-subcontainer");
      }); 
    }
  </script>
{% endblock %}
